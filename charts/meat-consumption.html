<!DOCTYPE html>
<html>
<head>

  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.1/jquery.min.js"></script>
  <script src="http://documentcloud.github.io/underscore/underscore-min.js"></script>
  <script type="text/javascript" src="https://www.google.com/jsapi"></script>
  <script type="text/javascript" src= "//cdnjs.cloudflare.com/ajax/libs/tabletop.js/1.1.0/tabletop.min.js"></script>
  <meta charset=utf-8 />
  <title>JS Bin</title>
</head>
<body>
<div id="chart_div">
<p>Food sorted by 'meatconsumption' column, reversed:</p>
<p id="the-chart"></p>
</div>
<script>
  var forGoogle = [['Country','Consumption']];
var data1;

function turntoarray(value, key, list) {
tuple1 = [];
//      console.log("value...");
//        console.dir(value);
//        console.log("key...");
//        console.log(key);
//        console.log("list...");
//        console.dir(list);
//        console.log(value.meatconsumption);
//        console.log(value.location);
data1.push(value.location);
data1.push(parseFloat(value.meatconsumption));
console.log(data1);
forGoogle.push(data1);
return forGoogle;
//console.log("HERE");
//        console.log("value: "+value   + " key: " +" list: " +list);
//return forGoogle;
}
// console.log("forGoogle");
// console.log(forGoogle);

window.onload = function () {
init();
  drawChart();
};

var public_spreadsheet_url = 'https://docs.google.com/spreadsheet/pub?key=0Ao3Ts9D8bHHpdC1FUTFMWVc3NHFpQ3d2RXU2WWdSVWc&output=html';

function init() {
// because we're using orderby: 'name' it will sort by the 'name' column
// and reverse: true will reverse that sort, so it should be in reverse
// alphabetical order
Tabletop.init({
key: public_spreadsheet_url,
callback: showInfo,
simpleSheet: true,
orderby: 'meatconsumption',
reverse: true
});
}

function showInfo(data) {

// data comes through as a simple array since simpleSheet is turned on
document.getElementById("the-chart")
.innerHTML = "<strong>Countries:</strong> " + [data[0].location, data[1].location, data[2].location].join(", ");
// console.dir(data);
//_.each(data, turntoarray);
var datavalues = _.values(data);
 console.log(datavalues);
// var arr = jQuery.makeArray( data );
// console.log(arr);
console.log(forGoogle);
}
  google.load("visualization", "1", {packages: ["corechart"]});
  console.log('You are here first');

google.setOnLoadCallback(drawChart);


  //console.log(forGoogle);
function drawChart() {

console.log('You are here');
console.log(".............." + forGoogle);
var meatdataforchart = google.visualization.arrayToDataTable(forGoogle);
//console.log(data);

  var options = {
  title: 'Meat Consumption',
  vAxis: {title: 'Location',titleTextStyle: {color: 'red'}}
};

var chart = new google.visualization.BarChart(document.getElementById('the-chart'));
console.log(chart);
chart.draw(meatdataforchart, options);


}
    </script>
</body></html>